name: Docker Image CI

on:
  push:
    branches: [ "main" ]
  pull_request:
    branches: [ "main" ]

jobs:

  build-and-publish:

    runs-on: ubuntu-latest

    steps:
    - name: Bootstrap app
      working-directory: ./scripts
      run: bootstrap.sh 
    - name: Build  app
      working-directory: ./scripts
      run: build.sh {{ secrets.VERSION }}
    - name: Build  app
      working-directory: ./docker
      run: bash ./docker/publish.sh {{ secrets.NAME }} {{ secrets.VERSION }} {{ secrets.USR }} {{ secrets.PSW }}
